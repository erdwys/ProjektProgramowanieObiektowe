<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" 
      xmlns:th="http://www.thymeleaf.org" 
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
    
 <head>
 <title>Panel Użytkownika</title>
 <link rel="stylesheet" type="text/css"
	href="webjars/bootstrap/3.3.7/css/bootstrap.min.css" />
        <link rel="stylesheet" type="text/css" media="all"  
     href="../css/user.css"  th:href="@{/css/user.css}" />
        
           <meta charset="utf-8" />


        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
        <link rel="stylesheet" href="https://cdn.datatables.net/1.10.16/css/jquery.dataTables.min.css"/>
        <link rel="stylesheet" href="https://cdn.datatables.net/buttons/1.5.1/css/buttons.dataTables.min.css"/>
        <link rel="stylesheet" href="https://cdn.datatables.net/select/1.2.5/css/select.dataTables.min.css"/>
        <link rel="stylesheet" type="text/css" media="all"  
              href="../css/editor.dataTables.min.css"  th:href="@{/css/editor.dataTables.min.css}" />

        <script src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>


        <script src="https://cdn.datatables.net/buttons/1.5.1/js/dataTables.buttons.min.js"></script>
        <script src="https://cdn.datatables.net/select/1.2.5/js/dataTables.select.min.js"></script>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/pdfmake.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/vfs_fonts.js"></script>
        <script src="https://cdn.datatables.net/buttons/1.5.1/js/buttons.html5.min.js"></script>
        
 </head>
 <body>
     <nav class="navbar navbar-inverse">
		<div  class="container">
			<div class="navbar-header">
				<a class="navbar-brand " th:href="@{/user}">Panel Użytkownika</a>
			</div>
			
		</div>
	</nav>
      <nav class="navbar navbar-inverse">
		<div  class="container">
     <div id="navbar" class="collapse navbar-collapse">
				<ul class="nav navbar-nav">
                           <li ><a href="#start" th:href="@{/user}">Start</a></li>
			 <li><a href="#rozrachunki" th:href="@{/user_Rozrachunki}">Rozrachunki</a></li>
                        <li><a href="#zobowiazania" th:href="@{/user_Zobowiazania}">Zobowiązania</a></li>
                        <li><a href="#bank" th:href="@{/user_bank}">Konto bankowe</a></li>
                          <li ><a href="#licznik" th:href="@{/user_licznik}">Odczyt liczników</a></li>
                             <li class="active"><a th:href="@{/user_konto}">Konto</a></li>
                                   <li style="  position: absolute; left: 94%; background-color: black">

                            <a th:href="@{/login?logout}" onclick="$('#form').submit();">
                                Wyloguj
                            </a>
                            <form style="visibility: hidden" id="form" method="post"  th:action="@{/logout}"></form>
                        </li>
                    </ul>
                </div>

            </div>
        </nav>



        <table id="user_konto_Table" class="display" cellspacing="0" width="100%">

            <!-- Header Table -->
            <thead class="display headAndFooter">
                <tr>
                    <th>Login</th>
                    <th>Hasło</th>                            
                </tr>
            </thead>

         
        </table>
        <script src="/jQuery-2.1.4.min.js"></script>
        <script src="/jquery.dataTables.js"></script>
        <script src="/dataTables.bootstrap.min.js"></script>
        <script src="/jquery.spring-friendly.js"></script>
        <script src="../../js/dataTables.editor.min.js"></script>

        <script>


                                $(document).ready(function () {


   editor = new $.fn.dataTable.Editor({

                                         ajax: {
                                                       
                                                        edit: {
                                                                type: 'PUT',
                                                             url: "/user_konto/update",
                                                dataType: 'json',
                                                contentType: 'application/json; charset=utf-8',
                                                
                                                data: function (d) {
                                                    var obj;
                                                    for (var key in d.data) {
                                                        obj = d.data[key];
                                                        break;
                                                    }
                                                    return JSON.stringify(obj);
                                                },
                                                success: function (data) {
                                                    table.clear().draw();
                                                    table.ajax.reload();
                                                },
                                                error: function (e) {
                                                    alert("ERROR: ", e);
                                                }

                                                        }
                                                     
                                                },
                                        "table": "#user_konto_Table",
                                        idSrc: "nrDzialkowicza",
                                        "fields": [ {
                                                   "label": "login",
                                                "name": "login"
                                            }, {
                                               "label": "password",
                                                "name": "password"
                                            }
                                        ]
                                    });


                                    var table = $('#user_konto_Table').DataTable({
                                          dom: "Bfrtip",
                                        "processing": true,
                                        "serverSide": false,
                                        "sAjaxSource": "/user_konto/get",
                                        "sAjaxDataProp": "",
                                        dataType: 'json',
                                          columns: [
                                            {data: "login"},
                                            {data: "password"}                                     

                                        ],

                                        select: true,
                                        idSrc: "nrDzialkowicza",
                                                buttons: [
                                                 {extend: "edit",   editor: editor},
                                            {extend: 'pdfHtml5', orientation: 'landscape',
                                                pageSize: 'LEGAL', download: 'open'}
                                                ]
                                    });
                                });

// Helper function to serialize all the form fields into a JSON string
                                function formToJSON() {
                                        return JSON.stringify({
                                              
                                                "login": $('#login').val(),
                                          "password": $('#password').val()
                                            
                                            });
                                }



        </script>




    </body>
</html>